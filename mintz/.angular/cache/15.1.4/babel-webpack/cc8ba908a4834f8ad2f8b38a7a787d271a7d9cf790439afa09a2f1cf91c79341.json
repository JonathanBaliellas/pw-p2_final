{"ast":null,"code":"import { Cliente } from '../cliente/cliente.model';\nimport { Pedido } from '../pedidos/pedido.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/carrinho.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/pedido.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction CarrinhoComponent_section_2_li_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"li\", 9);\n    i0.ɵɵelement(1, \"img\", 10);\n    i0.ɵɵelementStart(2, \"p\", 11);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 11);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"label\", 11);\n    i0.ɵɵtext(8, \" Quantidade: \");\n    i0.ɵɵelementStart(9, \"input\", 12);\n    i0.ɵɵlistener(\"ngModelChange\", function CarrinhoComponent_section_2_li_2_Template_input_ngModelChange_9_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const itemCarrinho_r4 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(itemCarrinho_r4.quantidade = $event);\n    })(\"change\", function CarrinhoComponent_section_2_li_2_Template_input_change_9_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r7.calcularTotal());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function CarrinhoComponent_section_2_li_2_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const itemCarrinho_r4 = restoredCtx.$implicit;\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.removerItem(itemCarrinho_r4.id));\n    });\n    i0.ɵɵelement(11, \"i\", 14);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const itemCarrinho_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", itemCarrinho_r4.imagem, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(itemCarrinho_r4.descricao);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind3(6, 4, itemCarrinho_r4.preco, \"BRL\", \"R$ \"));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", itemCarrinho_r4.quantidade);\n  }\n}\nfunction CarrinhoComponent_section_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"section\", 3)(1, \"ul\");\n    i0.ɵɵtemplate(2, CarrinhoComponent_section_2_li_2_Template, 12, 8, \"li\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"section\", 3)(4, \"h2\", 5);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 6)(8, \"div\", 7)(9, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function CarrinhoComponent_section_2_Template_button_click_9_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.comprar());\n    });\n    i0.ɵɵtext(10, \"Finalizar a compra\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"div\", 7)(12, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function CarrinhoComponent_section_2_Template_button_click_12_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.limparCarrinho());\n    });\n    i0.ɵɵtext(13, \"Limpar carrinho\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.itensCarrinho);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Total: \", i0.ɵɵpipeBind4(6, 2, ctx_r0.total, \"BRL\", \"R$ \", \".2-2\"), \"\");\n  }\n}\nfunction CarrinhoComponent_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"section\", 15)(1, \"h2\");\n    i0.ɵɵelement(2, \"i\", 16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"h3\");\n    i0.ɵɵtext(4, \"Seu carrinho est\\u00E1 vazio\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6, \"Que tal navegar pelas ofertas e achar algo especial para voc\\u00EA?\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"button\", 17);\n    i0.ɵɵtext(8, \"Ver produtos\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport class CarrinhoComponent {\n  constructor(carrinhoService, router, pedidoService) {\n    this.carrinhoService = carrinhoService;\n    this.router = router;\n    this.pedidoService = pedidoService;\n    this.itensCarrinho = [];\n    this.total = 0.00;\n    this.cliente = new Cliente();\n  }\n  ngOnInit() {\n    this.consultarCarrinho();\n    this.calcularTotal();\n  }\n  removerItem(itemId) {\n    this.carrinhoService.removerCarrinho(itemId);\n    this.consultarCarrinho();\n    this.calcularTotal();\n  }\n  calcularTotal() {\n    this.total = this.itensCarrinho.reduce((prev, curr) => prev + curr.preco * curr.quantidade, 0);\n  }\n  consultarCarrinho() {\n    this.itensCarrinho = this.carrinhoService.obterCarrinho();\n  }\n  atualizarCarrinho() {\n    this.carrinhoService.atualizarCarrinho();\n  }\n  comprar() {\n    const clienteLogado = localStorage.getItem(\"cliente\");\n    if (clienteLogado != null) {\n      this.cliente = JSON.parse(clienteLogado);\n      //Gera o pedido\n      let pedido = new Pedido();\n      pedido.cliente_id = this.cliente.id;\n      pedido.status = \"Pagamento confirmado\";\n      pedido.valorFrete = 10;\n      pedido.valorTotal = this.total;\n      //Envia o pedido\n      let pedidoInserido = new Pedido();\n      pedidoInserido = this.pedidoService.inserir(pedido);\n      //Finaliza a compra\n      alert('Obrigado pela compra, ' + this.cliente.nome + '!\\nO código é: ' + pedidoInserido.getItem().ge);\n      this.carrinhoService.limparCarrinho();\n      this.router.navigate(['produtos']);\n    } else {\n      alert('Você não está logado');\n    }\n  }\n  limparCarrinho() {\n    this.carrinhoService.limparCarrinho();\n    this.consultarCarrinho();\n  }\n}\nCarrinhoComponent.ɵfac = function CarrinhoComponent_Factory(t) {\n  return new (t || CarrinhoComponent)(i0.ɵɵdirectiveInject(i1.CarrinhoService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.PedidoService));\n};\nCarrinhoComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CarrinhoComponent,\n  selectors: [[\"app-carrinho\"]],\n  decls: 5,\n  vars: 2,\n  consts: [[1, \"cart-title\", \"w3-text-indigo\", \"w3-margin\"], [\"class\", \"w3-margin\", 4, \"ngIf\", \"ngIfElse\"], [\"carrinhoVazio\", \"\"], [1, \"w3-margin\"], [\"class\", \"w3-card\", 4, \"ngFor\", \"ngForOf\"], [1, \"cart-total\", \"w3-text-indigo\"], [1, \"w3-container\", \"w3-center\"], [1, \"w3-half\"], [1, \"w3-button\", \"w3-indigo\", \"w3-hover-orange\", \"w3-round-large\", \"btn-comandos\", \"w3-margin\", 3, \"click\"], [1, \"w3-card\"], [1, \"w3-bar-item\", 3, \"src\"], [1, \"w3-bar-item\"], [\"type\", \"number\", \"id\", \"\", \"min\", \"1\", \"max\", \"99\", 1, \"input\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [1, \"w3-button\", \"w3-indigo\", \"w3-hover-orange\", \"w3-bar-item\", \"w3-right\", \"button-remove\", 3, \"click\"], [1, \"fa-solid\", \"fa-xmark\"], [1, \"w3-margin\", \"w3-padding-64\", \"w3-center\", \"w3-text-indigo\"], [1, \"fa-solid\", \"fa-cart-shopping\", \"icoVazio\"], [\"routerLink\", \"../produtos\", 1, \"w3-button\", \"w3-indigo\", \"w3-hover-orange\", \"w3-round-large\", \"w3-xlarge\", \"w3-margin\", \"w3-padding-16\", \"btnVerMais\"]],\n  template: function CarrinhoComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h2\", 0);\n      i0.ɵɵtext(1, \"Carrinho\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(2, CarrinhoComponent_section_2_Template, 14, 7, \"section\", 1);\n      i0.ɵɵtemplate(3, CarrinhoComponent_ng_template_3_Template, 9, 0, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\n    }\n    if (rf & 2) {\n      const _r1 = i0.ɵɵreference(4);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.itensCarrinho.length > 0)(\"ngIfElse\", _r1);\n    }\n  },\n  dependencies: [i4.NgForOf, i4.NgIf, i2.RouterLink, i5.DefaultValueAccessor, i5.NumberValueAccessor, i5.NgControlStatus, i5.MinValidator, i5.MaxValidator, i5.NgModel, i4.CurrencyPipe],\n  styles: [\".button-remove[_ngcontent-%COMP%]{\\r\\n    height: 100%;\\r\\n}\\r\\n\\r\\n.w3-card[_ngcontent-%COMP%]{\\r\\n    border-radius: 10px;\\r\\n}\\r\\n\\r\\n.btn-comandos[_ngcontent-%COMP%]{\\r\\n    width: 150px;\\r\\n}\\r\\n\\r\\n.cart-title[_ngcontent-%COMP%] {\\r\\n    font-size: 44px;\\r\\n    font-weight: 700;\\r\\n    padding: 8px 0;\\r\\n}\\r\\n\\r\\nli[_ngcontent-%COMP%] {\\r\\n    display: flex;\\r\\n    overflow: hidden;\\r\\n    margin: 10px 0;\\r\\n    height: 100px;\\r\\n    align-items: center;\\r\\n    justify-content: space-between;\\r\\n}\\r\\n\\r\\nimg[_ngcontent-%COMP%] {\\r\\n    width: 100px;\\r\\n    height: 100px;\\r\\n    display: block;\\r\\n}\\r\\n\\r\\n.cart-total[_ngcontent-%COMP%] {\\r\\n    font-size: 24px;\\r\\n    font-weight: 700;\\r\\n    padding: 8px 0;\\r\\n}\\r\\n\\r\\ninput[_ngcontent-%COMP%] {\\r\\n    width: 40px;\\r\\n    text-align: center;\\r\\n    border: none;\\r\\n    border-bottom: 1px solid gray;\\r\\n}\\r\\n.icoVazio[_ngcontent-%COMP%]{\\r\\n    font-size: 6rem;\\r\\n}\\r\\n.btnVerMais[_ngcontent-%COMP%]{\\r\\n    width: 250px;\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY2FycmluaG8vY2FycmluaG8uY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxZQUFZO0FBQ2hCOztBQUVBO0lBQ0ksZUFBZTtJQUNmLGdCQUFnQjtJQUNoQixjQUFjO0FBQ2xCOztBQUVBO0lBQ0ksYUFBYTtJQUNiLGdCQUFnQjtJQUNoQixjQUFjO0lBQ2QsYUFBYTtJQUNiLG1CQUFtQjtJQUNuQiw4QkFBOEI7QUFDbEM7O0FBRUE7SUFDSSxZQUFZO0lBQ1osYUFBYTtJQUNiLGNBQWM7QUFDbEI7O0FBRUE7SUFDSSxlQUFlO0lBQ2YsZ0JBQWdCO0lBQ2hCLGNBQWM7QUFDbEI7O0FBRUE7SUFDSSxXQUFXO0lBQ1gsa0JBQWtCO0lBQ2xCLFlBQVk7SUFDWiw2QkFBNkI7QUFDakM7QUFDQTtJQUNJLGVBQWU7QUFDbkI7QUFDQTtJQUNJLFlBQVk7QUFDaEIiLCJzb3VyY2VzQ29udGVudCI6WyIuYnV0dG9uLXJlbW92ZXtcclxuICAgIGhlaWdodDogMTAwJTtcclxufVxyXG5cclxuLnczLWNhcmR7XHJcbiAgICBib3JkZXItcmFkaXVzOiAxMHB4O1xyXG59XHJcblxyXG4uYnRuLWNvbWFuZG9ze1xyXG4gICAgd2lkdGg6IDE1MHB4O1xyXG59XHJcblxyXG4uY2FydC10aXRsZSB7XHJcbiAgICBmb250LXNpemU6IDQ0cHg7XHJcbiAgICBmb250LXdlaWdodDogNzAwO1xyXG4gICAgcGFkZGluZzogOHB4IDA7XHJcbn1cclxuXHJcbmxpIHtcclxuICAgIGRpc3BsYXk6IGZsZXg7XHJcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xyXG4gICAgbWFyZ2luOiAxMHB4IDA7XHJcbiAgICBoZWlnaHQ6IDEwMHB4O1xyXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcclxufVxyXG5cclxuaW1nIHtcclxuICAgIHdpZHRoOiAxMDBweDtcclxuICAgIGhlaWdodDogMTAwcHg7XHJcbiAgICBkaXNwbGF5OiBibG9jaztcclxufVxyXG5cclxuLmNhcnQtdG90YWwge1xyXG4gICAgZm9udC1zaXplOiAyNHB4O1xyXG4gICAgZm9udC13ZWlnaHQ6IDcwMDtcclxuICAgIHBhZGRpbmc6IDhweCAwO1xyXG59XHJcblxyXG5pbnB1dCB7XHJcbiAgICB3aWR0aDogNDBweDtcclxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxuICAgIGJvcmRlcjogbm9uZTtcclxuICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCBncmF5O1xyXG59XHJcbi5pY29WYXppb3tcclxuICAgIGZvbnQtc2l6ZTogNnJlbTtcclxufVxyXG4uYnRuVmVyTWFpc3tcclxuICAgIHdpZHRoOiAyNTBweDtcclxufSJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["Cliente","Pedido","i0","CarrinhoComponent","constructor","carrinhoService","router","pedidoService","ngOnInit","consultarCarrinho","calcularTotal","removerItem","itemId","removerCarrinho","total","itensCarrinho","reduce","prev","curr","preco","quantidade","obterCarrinho","atualizarCarrinho","comprar","clienteLogado","localStorage","getItem","cliente","JSON","parse","pedido","cliente_id","id","status","valorFrete","valorTotal","pedidoInserido","inserir","alert","nome","ge","limparCarrinho","navigate","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["D:\\OneDrive - Fatec Centro Paula Souza\\Documentos\\Estudos\\Fatec_ADS\\4-Web\\pw-p2\\mintz\\src\\app\\carrinho\\carrinho.component.ts","D:\\OneDrive - Fatec Centro Paula Souza\\Documentos\\Estudos\\Fatec_ADS\\4-Web\\pw-p2\\mintz\\src\\app\\carrinho\\carrinho.component.html"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { CarrinhoService } from '../services/carrinho.service';\r\nimport { IProdutoCarrinho } from '../produtos';\r\nimport { PedidoService } from '../services/pedido.service';\r\nimport { Cliente } from '../cliente/cliente.model';\r\nimport { Pedido } from '../pedidos/pedido.model';\r\n\r\n@Component({\r\n  selector: 'app-carrinho',\r\n  templateUrl: './carrinho.component.html',\r\n  styleUrls: ['./carrinho.component.css']\r\n})\r\nexport class CarrinhoComponent {\r\n  itensCarrinho: IProdutoCarrinho[] = [];\r\n  total: number = 0.00;\r\n  cliente: Cliente = new Cliente();\r\n\r\n  constructor(\r\n    public carrinhoService: CarrinhoService,\r\n    private router: Router,\r\n    public pedidoService: PedidoService\r\n  ){}\r\n\r\n  ngOnInit():void{\r\n    this.consultarCarrinho();\r\n    this.calcularTotal();\r\n  }\r\n\r\n  removerItem(itemId: number){\r\n    this.carrinhoService.removerCarrinho(itemId);\r\n    this.consultarCarrinho();\r\n    this.calcularTotal();\r\n  }\r\n\r\n  calcularTotal(){\r\n    this.total = this.itensCarrinho.reduce((prev, curr) => prev + (curr.preco * curr.quantidade), 0);\r\n  }\r\n\r\n  consultarCarrinho(){\r\n    this.itensCarrinho = this.carrinhoService.obterCarrinho();\r\n  }\r\n\r\n  atualizarCarrinho(){\r\n    this.carrinhoService.atualizarCarrinho();\r\n  }\r\n\r\n  comprar(){\r\n    const clienteLogado = localStorage.getItem(\"cliente\");\r\n    if (clienteLogado != null) {\r\n      this.cliente = JSON.parse(clienteLogado);\r\n\r\n      //Gera o pedido\r\n      let pedido = new Pedido();\r\n      pedido.cliente_id = this.cliente.id;\r\n      pedido.status = \"Pagamento confirmado\";\r\n      pedido.valorFrete = 10;\r\n      pedido.valorTotal = this.total;\r\n      \r\n      //Envia o pedido\r\n      let pedidoInserido = new Pedido();\r\n      pedidoInserido = this.pedidoService.inserir(pedido);\r\n\r\n      //Finaliza a compra\r\n      alert('Obrigado pela compra, ' + this.cliente.nome + '!\\nO código é: ' + pedidoInserido.getItem().ge);\r\n      this.carrinhoService.limparCarrinho();\r\n      this.router.navigate(['produtos']);\r\n    } else {\r\n      alert('Você não está logado');\r\n    }\r\n  }\r\n\r\n  limparCarrinho(){\r\n    this.carrinhoService.limparCarrinho();\r\n    this.consultarCarrinho();\r\n  }\r\n}\r\n","<h2 class=\"cart-title w3-text-indigo w3-margin\">Carrinho</h2>\r\n<section class=\"w3-margin\" *ngIf=\"itensCarrinho.length > 0; else carrinhoVazio\">\r\n    <!-- Lista de itens -->\r\n    <ul>\r\n        <li class=\"w3-card\" *ngFor=\"let itemCarrinho of itensCarrinho\">\r\n            <img [src]=\"itemCarrinho.imagem\" class=\"w3-bar-item\">\r\n            <p class=\"w3-bar-item\">{{itemCarrinho.descricao}}</p>\r\n            <p class=\"w3-bar-item\">{{itemCarrinho.preco | currency:'BRL' : 'R$ '}}</p>\r\n            <label class=\"w3-bar-item\">\r\n                Quantidade: \r\n                <input type=\"number\" class=\"input\" id=\"\" min=\"1\" max=\"99\" [(ngModel)]=\"itemCarrinho.quantidade\" (change)=\"calcularTotal()\">\r\n            </label>\r\n            <button class=\"w3-button w3-indigo w3-hover-orange w3-bar-item w3-right button-remove\" (click)=\"removerItem(itemCarrinho.id)\"><i class=\"fa-solid fa-xmark\"></i></button>\r\n        </li>\r\n    </ul>\r\n\r\n    <!-- Total e Comandos -->\r\n    <section class=\"w3-margin\">\r\n        <h2 class=\"cart-total w3-text-indigo\">Total: {{total | currency:'BRL' : 'R$ ' : '.2-2'}}</h2>\r\n        \r\n        <!-- Botões -->\r\n        <div class=\"w3-container w3-center\">\r\n            <div class=\"w3-half\">\r\n                <button class=\"w3-button w3-indigo w3-hover-orange w3-round-large btn-comandos w3-margin\" (click)=\"comprar()\">Finalizar a compra</button>\r\n\r\n            </div>\r\n            <div class=\"w3-half\">\r\n                <button class=\"w3-button w3-indigo w3-hover-orange w3-round-large btn-comandos w3-margin\" (click)=\"limparCarrinho()\">Limpar carrinho</button>\r\n\r\n            </div>\r\n        </div>\r\n    </section>\r\n</section>\r\n\r\n<ng-template #carrinhoVazio>\r\n    <section class=\"w3-margin w3-padding-64 w3-center w3-text-indigo\">\r\n        <h2><i class=\"fa-solid fa-cart-shopping icoVazio\"></i></h2>\r\n        <h3>Seu carrinho está vazio</h3>\r\n        <p>Que tal navegar pelas ofertas e achar algo especial para você?</p>\r\n        <button class=\"w3-button w3-indigo w3-hover-orange w3-round-large w3-xlarge w3-margin w3-padding-16 btnVerMais\" routerLink=\"../produtos\">Ver produtos</button>\r\n    </section>\r\n</ng-template>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}