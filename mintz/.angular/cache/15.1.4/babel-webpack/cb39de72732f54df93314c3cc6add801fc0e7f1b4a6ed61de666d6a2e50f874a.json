{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Cliente } from '../cliente/cliente.model';\nimport { switchMap } from 'rxjs';\nimport { Produtos } from '../produtos/produtos.model';\nlet PedidosComponent = class PedidosComponent {\n  constructor(pedidoService, pedidoProdutoService, produtoService, route) {\n    this.pedidoService = pedidoService;\n    this.pedidoProdutoService = pedidoProdutoService;\n    this.produtoService = produtoService;\n    this.route = route;\n    this.listaPedidos = [];\n    this.listaPedidoProdutos = [];\n    this.listaProdutos = [];\n    this.cliente = new Cliente();\n  }\n  ngOnInit() {\n    const clienteLogado = localStorage.getItem(\"cliente\");\n    if (clienteLogado != null) {\n      this.cliente = JSON.parse(clienteLogado);\n      this.route.queryParams.pipe(\n      // switchMap troca para um novo observable\n      switchMap(() => this.pedidoService.listar(this.cliente.id))).subscribe(pedidos => {\n        // O resultado final é atribuído a this.produtos\n        this.listaPedidos = pedidos;\n      });\n    }\n  }\n  mostrarDetalhesPedido(pedido_id) {\n    //Consulta a lista de produtos do pedido\n    this.route.queryParams.pipe(switchMap(() => this.pedidoProdutoService.listar(pedido_id))).subscribe(produtos => {\n      this.listaPedidoProdutos = produtos;\n    });\n    //Insere \n    this.listaPedidoProdutos.forEach(element => {\n      try {\n        //Recupera informações do produto\n        let produto = new Produtos();\n        this.produtoService.consultar(element.produto_id).subscribe(resposta => {\n          produto = resposta;\n        });\n        //Adiciona a quantidade no pedido\n        const pedidoProduto = {\n          ...produto,\n          quantidade: element.quant\n        };\n        //Insere o produto na lista\n        this.listaProdutos.push(pedidoProduto);\n      } catch (error) {}\n    });\n    //Mostra o modal\n    document.getElementById('divDetalhesPedido').style.display = 'block';\n  }\n};\nPedidosComponent = __decorate([Component({\n  selector: 'app-pedidos',\n  templateUrl: './pedidos.component.html',\n  styleUrls: ['./pedidos.component.css']\n})], PedidosComponent);\nexport { PedidosComponent };","map":{"version":3,"mappings":";AAAA,SAASA,SAAS,QAAQ,eAAe;AAGzC,SAASC,OAAO,QAAQ,0BAA0B;AAElD,SAAcC,SAAS,QAAQ,MAAM;AAKrC,SAASC,QAAQ,QAAQ,4BAA4B;AAO9C,IAAMC,gBAAgB,GAAtB,MAAMA,gBAAgB;EAM3BC,YACSC,aAA4B,EAC5BC,oBAA0C,EAC1CC,cAA+B,EAC9BC,KAAqB;IAHtB,kBAAa,GAAbH,aAAa;IACb,yBAAoB,GAApBC,oBAAoB;IACpB,mBAAc,GAAdC,cAAc;IACb,UAAK,GAALC,KAAK;IATf,iBAAY,GAAa,EAAE;IAC3B,wBAAmB,GAAoB,EAAE;IACzC,kBAAa,GAAuB,EAAE;IACtC,YAAO,GAAY,IAAIR,OAAO,EAAE;EAO9B;EAEFS,QAAQ;IACN,MAAMC,aAAa,GAAGC,YAAY,CAACC,OAAO,CAAC,SAAS,CAAC;IACrD,IAAIF,aAAa,IAAI,IAAI,EAAE;MACzB,IAAI,CAACG,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACL,aAAa,CAAC;MAExC,IAAI,CAACF,KAAK,CAACQ,WAAW,CAACC,IAAI;MACzB;MACAhB,SAAS,CAAC,MAAM,IAAI,CAACI,aAAa,CAACa,MAAM,CAAC,IAAI,CAACL,OAAO,CAACM,EAAE,CAAC,CAAC,CAC5D,CAACC,SAAS,CAACC,OAAO,IAAG;QACpB;QACA,IAAI,CAACC,YAAY,GAAGD,OAAO;MAC7B,CAAC,CAAC;;EAEN;EAEAE,qBAAqB,CAACC,SAAiB;IACrC;IACA,IAAI,CAAChB,KAAK,CAACQ,WAAW,CAACC,IAAI,CACzBhB,SAAS,CAAC,MAAM,IAAI,CAACK,oBAAoB,CAACY,MAAM,CAACM,SAAS,CAAC,CAAC,CAC7D,CAACJ,SAAS,CAACK,QAAQ,IAAG;MACnB,IAAI,CAACC,mBAAmB,GAAGD,QAAQ;IACrC,CAAC,CACF;IAED;IACA,IAAI,CAACC,mBAAmB,CAACC,OAAO,CAACC,OAAO,IAAG;MACzC,IAAI;QACF;QACA,IAAIC,OAAO,GAAa,IAAI3B,QAAQ;QACpC,IAAI,CAACK,cAAc,CAACuB,SAAS,CAACF,OAAO,CAACG,UAAU,CAAC,CAACX,SAAS,CACxDY,QAAkB,IAAI;UACrBH,OAAO,GAAGG,QAAQ;QACpB,CAAC,CACF;QAED;QACA,MAAMC,aAAa,GAAqB;UACtC,GAAGJ,OAAO;UACVK,UAAU,EAAEN,OAAO,CAACO;SACrB;QAED;QACA,IAAI,CAACC,aAAa,CAACC,IAAI,CAACJ,aAAa,CAAC;OACvC,CAAC,OAAOK,KAAK,EAAE;IAGlB,CAAC,CAAC;IAEF;IACCC,QAAQ,CAACC,cAAc,CAAC,mBAAmB,CAAiB,CAACC,KAAK,CAACC,OAAO,GAAC,OAAO;EACrF;CACD;AAhEYvC,gBAAgB,eAL5BJ,SAAS,CAAC;EACT4C,QAAQ,EAAE,aAAa;EACvBC,WAAW,EAAE,0BAA0B;EACvCC,SAAS,EAAE,CAAC,yBAAyB;CACtC,CAAC,GACW1C,gBAAgB,CAgE5B;SAhEYA,gBAAgB","names":["Component","Cliente","switchMap","Produtos","PedidosComponent","constructor","pedidoService","pedidoProdutoService","produtoService","route","ngOnInit","clienteLogado","localStorage","getItem","cliente","JSON","parse","queryParams","pipe","listar","id","subscribe","pedidos","listaPedidos","mostrarDetalhesPedido","pedido_id","produtos","listaPedidoProdutos","forEach","element","produto","consultar","produto_id","resposta","pedidoProduto","quantidade","quant","listaProdutos","push","error","document","getElementById","style","display","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["D:\\OneDrive - Fatec Centro Paula Souza\\Documentos\\Estudos\\Fatec_ADS\\4-Web\\pw-p2\\mintz\\src\\app\\pedidos\\pedidos.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { Pedido } from './pedido.model';\r\nimport { PedidoService } from '../services/pedido.service';\r\nimport { Cliente } from '../cliente/cliente.model';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { map, switchMap } from 'rxjs';\r\nimport { PedidoProduto } from './pedido-produto.model';\r\nimport { PedidoProdutoService } from '../services/pedido-produto.service';\r\nimport { IProdutoCarrinho } from '../produtos';\r\nimport { ProdutosService } from '../services/produtos.service';\r\nimport { Produtos } from '../produtos/produtos.model';\r\n\r\n@Component({\r\n  selector: 'app-pedidos',\r\n  templateUrl: './pedidos.component.html',\r\n  styleUrls: ['./pedidos.component.css']\r\n})\r\nexport class PedidosComponent {\r\n  listaPedidos: Pedido[] = [];\r\n  listaPedidoProdutos: PedidoProduto[] = [];\r\n  listaProdutos: IProdutoCarrinho[] = []\r\n  cliente: Cliente = new Cliente();\r\n\r\n  constructor(\r\n    public pedidoService: PedidoService,\r\n    public pedidoProdutoService: PedidoProdutoService,\r\n    public produtoService: ProdutosService,\r\n    private route: ActivatedRoute\r\n  ){}\r\n\r\n  ngOnInit(){\r\n    const clienteLogado = localStorage.getItem(\"cliente\");\r\n    if (clienteLogado != null) {\r\n      this.cliente = JSON.parse(clienteLogado);\r\n\r\n      this.route.queryParams.pipe(\r\n        // switchMap troca para um novo observable\r\n        switchMap(() => this.pedidoService.listar(this.cliente.id))\r\n      ).subscribe(pedidos => {\r\n        // O resultado final é atribuído a this.produtos\r\n        this.listaPedidos = pedidos;\r\n      });\r\n    }\r\n  }\r\n\r\n  mostrarDetalhesPedido(pedido_id: number){\r\n    //Consulta a lista de produtos do pedido\r\n    this.route.queryParams.pipe(\r\n      switchMap(() => this.pedidoProdutoService.listar(pedido_id))\r\n    ).subscribe(produtos => {\r\n        this.listaPedidoProdutos = produtos;\r\n      }\r\n    )\r\n    \r\n    //Insere \r\n    this.listaPedidoProdutos.forEach(element => {\r\n      try {\r\n        //Recupera informações do produto\r\n        let produto: Produtos = new Produtos;\r\n        this.produtoService.consultar(element.produto_id).subscribe(\r\n          (resposta: Produtos) => {\r\n            produto = resposta;\r\n          }\r\n        );\r\n\r\n        //Adiciona a quantidade no pedido\r\n        const pedidoProduto: IProdutoCarrinho = {\r\n          ...produto,\r\n          quantidade: element.quant\r\n        }\r\n\r\n        //Insere o produto na lista\r\n        this.listaProdutos.push(pedidoProduto);\r\n      } catch (error) {\r\n        \r\n      }\r\n    });\r\n\r\n    //Mostra o modal\r\n    (document.getElementById('divDetalhesPedido') as HTMLElement).style.display='block';\r\n  }\r\n}\r\n    "]},"metadata":{},"sourceType":"module","externalDependencies":[]}